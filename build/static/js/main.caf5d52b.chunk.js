(this["webpackJsonpcoup-modified"]=this["webpackJsonpcoup-modified"]||[]).push([[0],{100:function(e,a,t){},101:function(e,a,t){},102:function(e,a,t){},103:function(e,a,t){},104:function(e,a,t){},105:function(e,a,t){},135:function(e,a){},142:function(e,a,t){},143:function(e,a,t){},144:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(74),l=t.n(r),o=t(11),s=t(53),i=t(3),u=t.n(i),m=t(5),g=t(7),d=(t(86),function(e){return c.a.createElement("div",{className:"lobby-container"},c.a.createElement("div",{className:"game-title"},"online coup"),e.children,c.a.createElement("div",{className:"game-info"},"Developed by vyang1222 -"," ",c.a.createElement("a",{href:"https://github.com/vyang1222/online-coup",rel:"noopener noreferrer",target:"_blank"},"about this project."),"\n","Based on the original Coup board game by Indie Boards & Cards."))}),h=t(8),p=t(10),f=t(75),y=window.location,v=y.origin,b=(y.protocol,y.hostname,v),E=function(){function e(){Object(h.a)(this,e),this.api=f.a.create({prefixUrl:"".concat(b,"/games/").concat("Coup")})}return Object(p.a)(e,[{key:"createRoom",value:function(){var e=Object(m.a)(u.a.mark((function e(a){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.post("create",{json:{numPlayers:a}}).json();case 3:return t=e.sent,e.abrupt("return",t.gameID);case 7:e.prev=7,e.t0=e.catch(0),console.log("failed to create room:",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(a){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=Object(m.a)(u.a.mark((function e(a,t,n){var c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.post(a+"/join",{json:{playerID:t,playerName:n}}).json();case 3:return c=e.sent,r=c.playerCredentials,e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(0),console.log("failed to join room:",e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(a,t,n){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=Object(m.a)(u.a.mark((function e(a,t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.post(a+"/leave",{json:{playerID:t,credentials:n}}).json();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("failed to leave room:",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(a,t,n){return e.apply(this,arguments)}}()},{key:"playAgain",value:function(){var e=Object(m.a)(u.a.mark((function e(a,t,n){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.post(a+"/playAgain",{json:{playerID:t,credentials:n}}).json();case 3:return c=e.sent,e.abrupt("return",c.nextRoomID);case 7:e.prev=7,e.t0=e.catch(0),console.log("failed to play again:",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(a,t,n){return e.apply(this,arguments)}}()},{key:"getPlayers",value:function(){var e=Object(m.a)(u.a.mark((function e(a){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get(a).json();case 2:return t=e.sent,e.abrupt("return",t.players);case 4:case"end":return e.stop()}}),e,this)})));return function(a){return e.apply(this,arguments)}}()},{key:"getRooms",value:function(){var e=Object(m.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("").json();case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),k=(t(87),new E),L=function(e){var a=e.history,t=Object(n.useState)(""),r=Object(g.a)(t,2),l=r[0],o=r[1],s=Object(n.useState)(""),i=Object(g.a)(s,2),h=i[0],p=i[1],f=12-h.length,y=Object(n.useState)(2),v=Object(g.a)(y,2),b=v[0],E=v[1],L=Object(n.useState)(""),O=Object(g.a)(L,2),N=O[0],w=O[1],j=12-N.length,C=Object(n.useState)(""),x=Object(g.a)(C,2),P=x[0],I=x[1];Object(n.useEffect)((function(){var e;return a.location.state&&a.location.state.invalidRoom&&(I("room does not exist!"),e=setTimeout((function(){I(""),a.replace()}),4e3)),function(){clearTimeout(e)}}),[a]);var D=function(e,a){" "===e.key&&(a&&0!==a.length&&" "!==a.substring(a.length-1,a.length)||e.preventDefault())},A=function(e,a,t){localStorage.setItem("name",e),localStorage.setItem("id",a),localStorage.setItem("credentials",t)},B=function(){var e=Object(m.a)(u.a.mark((function e(t,n){var c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.getPlayers(t);case 3:c=e.sent,-1===c.filter((function(e){return e.name})).map((function(e){return e.name})).indexOf(n)?(r=c.find((function(e){return!e.name})).id,k.joinRoom(t,r,n).then((function(e){A(n,r,e),a.push("/rooms/"+t)}))):(I("name already taken!"),p(""),document.getElementById("joinName").value=""),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),I("room does not exist!"),o(""),document.getElementById("roomIdentification").value="";case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(a,t){return e.apply(this,arguments)}}();return c.a.createElement(d,null,c.a.createElement("span",{className:"title join-title"},"join game"),c.a.createElement("div",{className:"input-info-area"},c.a.createElement("p",{style:{margin:"0"}},"room id")),c.a.createElement("input",{id:"roomIdentification",type:"text",maxLength:"".concat(9),spellCheck:"false",autoComplete:"off",onKeyDown:function(e){return D(e)},onChange:function(e){return o(e.target.value)},className:"input-field"}),c.a.createElement("div",{className:"input-info-area"},c.a.createElement("p",{style:{margin:"0"}},"your name"),c.a.createElement("p",{style:{margin:"0 0 0 auto"}},f)),c.a.createElement("div",{className:"user-input"},c.a.createElement("input",{id:"joinName",type:"text",maxLength:"".concat(12),spellCheck:"false",autoComplete:"off",onKeyDown:function(e){return D(e,h)},onChange:function(e){return p(e.target.value)},onPaste:function(e){return e.preventDefault()},className:"input-field"})),c.a.createElement("button",{className:"lobby-btn",disabled:9!==l.length||0===h.length,onClick:function(){return B(l,h)}},"join"),c.a.createElement("div",{className:"error-msg"},P),c.a.createElement("span",{className:"title create-title"},"create lobby"),c.a.createElement("div",{className:"input-info-area"},c.a.createElement("p",{style:{margin:"0"}},"# players: ",b)),c.a.createElement("input",{type:"range",min:"2",max:"8",value:b,autoComplete:"off",onChange:function(e){return E(e.target.value)},className:"input-slider"}),c.a.createElement("div",{className:"input-info-area"},c.a.createElement("p",{style:{margin:"0"}},"your name"),c.a.createElement("p",{style:{margin:"0 0 0 auto"}},j)),c.a.createElement("div",{className:"user-input"},c.a.createElement("input",{type:"text",maxLength:"".concat(12),spellCheck:"false",autoComplete:"off",onKeyDown:function(e){return D(e,N)},onChange:function(e){return w(e.target.value)},onPaste:function(e){return e.preventDefault()},className:"input-field"})),c.a.createElement("button",{className:"lobby-btn",disabled:0===N.length,onClick:function(){k.createRoom(b).then((function(e){B(e,N)}))}},"create"))},O=t(78),N=t(41),w=t(16),j=t.n(w),C=t(6),x=t.n(C),P=(t(88),function(e){var a=e.deck,t=Object(n.useState)(1),r=Object(g.a)(t,2),l=r[0],o=r[1],s=Array(2).fill().map((function(e,a){return a+1})),i=a.slice().reverse();return c.a.createElement("div",{className:"deck-container"},c.a.createElement("div",null,c.a.createElement("div",{className:"deck-title"},"Deck:"),c.a.createElement("div",null,s.map((function(e){return c.a.createElement("button",{key:x()(),onClick:function(){return function(e){o(e)}(e)},className:"page-btn ".concat(l===e?"btn-selected":"btn-unselected")},e)})))),c.a.createElement("div",{className:"deck-cards-container"},function(){var e=10*(l-1);return i.slice(e,Math.min(e+10,a.length))}().map((function(e){return c.a.createElement("img",{key:x()(),src:"".concat(e.front.replace(".PNG","-small.PNG")),className:"character-card-small",alt:e.character})}))))}),I=(t(89),function(e){var a=e.G,t=e.ctx,n=e.playerID,r=e.moves,l=a.players[n],o=t.currentPlayer===n,s=l.coins>=7,i=l.coins>=10,u=l.coins>=3,m=t.currentPlayer===a.turnLog.player.id||"-1"!==a.winner.id,g=function(e){r.prepAction(e)};return c.a.createElement("div",{hidden:"exchange"===a.turnLog.action&&a.turnLog.successful&&"action"===t.activePlayers[n]&&o},c.a.createElement("div",{className:j()("general-actions",{"actions-active-enter":o})},c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){r.income()},disabled:!o||i||m},"income")),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){return g("foreign aid")},disabled:!o||i||m},"foreign aid")),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){return g("coup")},disabled:!o||!s||m},"coup"))),c.a.createElement("div",{className:j()("character-actions",{"actions-active-enter":o})},c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){return g("tax")},disabled:!o||i||m},"tax")),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){return g("assassinate")},disabled:!o||!u||i||m},"assassinate")),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){return g("steal")},disabled:!o||i||m},"steal")),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"action-btn",onClick:function(){return g("exchange")},disabled:!o||i||m},"exchange"))))}),D=(t(90),function(e){var a=e.G,t=e.ctx,n=e.playerID,r=e.moves,l=e.revealDeck;return"-1"!==a.winner.id||a.players[n].isOut?l?c.a.createElement(P,{deck:a.deck}):"":c.a.createElement(I,{G:a,ctx:t,playerID:n,moves:r})}),A=t(12),B=t(13),S=(t(95),function(e){var a=e.G,t=e.playerID,r=e.moves,l=Object(n.useState)(""),o=Object(g.a)(l,2),s=o[0],i=o[1];return Object(n.useEffect)((function(){var e=document.getElementById("scrollBottom");e.scrollTop=e.scrollHeight}),[a.chat]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"scrollBottom",className:"msgs"},a.chat.map((function(e){var t="msg ";if("-1"===e.id){var n=e.content.split("\n");return t+="bot-msg ",c.a.createElement("div",{id:"playerMsg",className:t,key:x()()},c.a.createElement("span",{className:e.successful?"successful-color":"unsuccessful-color"},n[0]),c.a.createElement("div",{className:"addendums"},n.slice(1,n.length).map((function(e){return c.a.createElement("div",{key:x()()},e)}))))}return c.a.createElement("div",{id:"playerMsg",className:t,key:x()()},c.a.createElement("span",{className:"msg-sender"},a.players[e.id].name+": "),e.content)}))),c.a.createElement("div",{className:"chat-form"},c.a.createElement("input",{id:"player-msg",type:"text",maxLength:"70",placeholder:"Enter Message",onChange:function(e){return i(e.target.value)},onKeyUp:function(e){return function(e){e.preventDefault(),13===e.keyCode&&document.getElementById("send-button").click()}(e)},autoComplete:"off"}),c.a.createElement("button",{id:"send-button",className:"send-btn",onClick:function(){return e=s,r.message(t,e),document.getElementById("player-msg").value="",void i("");var e},disabled:0===s.length},c.a.createElement(A.a,{icon:B.f}))))}),R=(t(96),["Action",c.a.createElement("span",{className:"successful-color"},"\u2714"),c.a.createElement("span",{className:"unsuccessful-color"},"\u2718"),c.a.createElement("span",{className:"counteraction-color"},"\u2692"),c.a.createElement("span",{className:"counteraction-color"},"\u2694")]),T=function(e){var a=e.G,t=e.playerID,n=e.revealDeck,r=e.setRevealDeck,l=a.players[t],o=c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:n?"btn-selected":"btn-unselected",onClick:function(){r(!n)}},n?"hide":"reveal"," deck"),c.a.createElement("div",null,"click on a player to reveal/hide their hand"));return c.a.createElement("div",{className:"gameview-container"},c.a.createElement("table",{className:"gameview-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,R.map((function(e){return c.a.createElement("th",{key:x()()},e)})))),c.a.createElement("tbody",null,a.statistics.map((function(e){return c.a.createElement("tr",{key:x()()},e.map((function(e){return c.a.createElement("td",{key:x()(),className:"stat-desc"},e)})))})))),c.a.createElement("div",{className:"stat-legend"},c.a.createElement("span",null,R[1],"/",R[2],": # successful/unsuccessful"),c.a.createElement("span",null,R[3],"/",R[4],": # direct blocks/challenges")),c.a.createElement("div",{className:"deckview-container"},l.isOut||"-1"!==a.winner.id?o:c.a.createElement("span",{className:"deck-info"},"Deck: ".concat(a.deck.length," cards"))))},G=(t(97),Array(3).fill().map((function(e,a){return a+1}))),H=[c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"rules-intro-container"},c.a.createElement("span",{className:"rules-intro"},"take one action"),c.a.createElement("span",{className:"rules-intro-footer"},"(If 10+ coins must choose to launch Coup)")),c.a.createElement("div",{className:"rules-desc-container"},c.a.createElement("span",{className:"rules-title"},"General Actions"),c.a.createElement("table",{className:"rules-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Action"),c.a.createElement("th",null,"Effect"))),c.a.createElement("tbody",null,[["Income","take 1 coin"],["Foreign Aid","take 2 coins"],["Coup","pay 7 coins","choose player to lose guessed character upon correct guess"]].map((function(e){return c.a.createElement("tr",{key:x()()},c.a.createElement("td",null,e[0]),c.a.createElement("td",null,c.a.createElement("div",{className:"action-description"},e[1],e.slice(2).map((function(e){return c.a.createElement("span",{className:"extra-desc",key:x()()},e)})))))})))))),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"rules-desc-container"},c.a.createElement("div",{className:"rules-title"},"Character Actions"),c.a.createElement("table",{className:"rules-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Action"),c.a.createElement("th",null,"Effect"))),c.a.createElement("tbody",null,[["Tax","Duke","take 3 coins"],["Assassinate","Assassin","pay 3 coins","choose player to lose a character"],["Steal","Captain","take at most 2 coins from another player"],["Exchange","Ambassador","exchange hand with top 2 cards of deck"]].map((function(e){return c.a.createElement("tr",{className:"character-action-entry",key:x()()},c.a.createElement("td",null,e[0],c.a.createElement("div",{className:"character-footer"},"(",e[1],")")),c.a.createElement("td",null,c.a.createElement("div",{className:"action-description"},e[2],e.slice(3).map((function(e){return c.a.createElement("span",{className:"extra-desc",key:x()()},e)})))))})))))),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"rules-desc-container"},c.a.createElement("div",{className:"rules-title"},"Counteractions"),c.a.createElement("table",{className:"rules-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Character"),c.a.createElement("th",null,"Counteraction"))),c.a.createElement("tbody",null,[["Duke","blocks foreign aid"],["Ambassador","blocks stealing"],["Captain","blocks stealing"],["Contessa","blocks assassination"]].map((function(e){return c.a.createElement("tr",{key:x()()},c.a.createElement("td",null,e[0]),c.a.createElement("td",null,c.a.createElement("div",{className:"action-description"},e[1],e.slice(2).map((function(e){return c.a.createElement("span",{className:"extra-desc",key:x()()},e)})))))}))))))],M=function(e){var a=e.page,t=e.setPage;return c.a.createElement(c.a.Fragment,null,H[a-1],c.a.createElement("div",{className:"rules-pagebar"},G.map((function(e){return c.a.createElement("button",{key:x()(),onClick:function(){return function(e){t(e)}(e)},className:"page-btn ".concat(a===e?"btn-selected":"btn-unselected")},e)}))))},F=(t(98),["chat & log","game view","rules"]),_=function(e){var a=e.G,t=(e.ctx,e.playerID),r=e.moves,l=e.revealDeck,o=e.setRevealDeck,s=Object(n.useState)(0),i=Object(g.a)(s,2),u=i[0],m=i[1],d=Object(n.useState)(1),h=Object(g.a)(d,2),p=h[0],f=h[1],y=F[u];return c.a.createElement("div",{className:"cls-container"},c.a.createElement("div",{className:"cls-header"},c.a.createElement("span",{className:"left-option",onClick:function(){m(u-1<0?F.length-1:u-1)}},c.a.createElement(A.a,{icon:B.a})),c.a.createElement("span",{className:"cls-title"},y),c.a.createElement("span",{className:"right-option",onClick:function(){m(u+1>F.length-1?0:u+1)}},c.a.createElement(A.a,{icon:B.b}))),"chat & log"===y?c.a.createElement(S,{G:a,playerID:t,moves:r}):"game view"===y?c.a.createElement(T,{G:a,playerID:t,revealDeck:l,setRevealDeck:o}):"rules"===y?c.a.createElement(M,{page:p,setPage:f}):void 0)},K=function(e,a){return{character:e,front:a}},J=[K("Duke","/images/duke.PNG"),K("Assassin","/images/assassin.PNG"),K("Captain","/images/captain.PNG"),K("Ambassador","/images/ambassador.PNG"),K("Contessa","/images/contessa.PNG")],U=(t(99),new E),Y=function(e){var a=e.G,t=e.ctx,r=e.playerID,l=e.moves,o=e.gameID,s=Object(n.useState)([]),i=Object(g.a)(s,2),u=i[0],m=i[1];return Object(n.useEffect)((function(){if(""!==a.gameOver.newRoomID){var e=localStorage.getItem("id"),t=localStorage.getItem("credentials"),n=localStorage.getItem("name");U.leaveRoom(o,e,t).then((function(){U.joinRoom(a.gameOver.newRoomID,e,n).then((function(e){localStorage.setItem("credentials",e),window.location.href="/rooms/"+a.gameOver.newRoomID}))}))}}),[a.gameOver.newRoomID,o]),Object(n.useEffect)((function(){a.gameOver.playAgain.length===t.numPlayers&&""===a.gameOver.newRoomID&&r===a.gameOver.playAgain[0]&&U.createRoom(t.numPlayers).then((function(e){l.setNewRoom(e)}));var e=r===t.currentPlayer,n=function(){l.allow(r)},s=function(){l.block(r)},i=function(e){l.block(r,e)},u=function(){l.initiateChallenge(r)},g=[];if("-1"!==a.winner.id){document.getElementById("choosing_panel").style.flexDirection="column",document.getElementById("choosing_panel").style.alignItems="center",document.getElementById("choosing_panel").style.justifyContent="flex-start";var d="";0!==a.gameOver.left.length?d="play-again-disabled":a.gameOver.playAgain.includes(r)&&(d="play-again-selected"),g.push(c.a.createElement("button",{key:x()(),className:"play-again-btn ".concat(d),onClick:function(){l.playAgain(r)},disabled:0!==a.gameOver.left.length||a.gameOver.playAgain.includes(r)},"play again [",0!==a.gameOver.left.length?"N/A":"".concat(a.gameOver.playAgain.length,"/").concat(t.numPlayers),"]")),g.push(c.a.createElement("button",{key:x()(),className:"leave-btn",onClick:function(){l.leave(r),U.leaveRoom(o,localStorage.getItem("id"),localStorage.getItem("credentials")).then((function(){localStorage.clear(),window.location.href="/"}))}},"leave"))}else"steal"===a.turnLog.action&&0!==Object.keys(a.turnLog.blockedBy).length&&""===a.turnLog.blockedBy.character&&"blockOrChallenge"===t.activePlayers[r]?(g.push(c.a.createElement("img",{key:x()(),className:"character-choice",onClick:function(){return i("Ambassador")},src:"/images/ambassador.PNG",alt:"Ambassador"})),g.push(c.a.createElement("img",{key:x()(),className:"character-choice",onClick:function(){return i("Captain")},src:"/images/captain.PNG",alt:"Captain"}))):"coup"===a.turnLog.action&&e?J.forEach((function(e){g.push(c.a.createElement("img",{key:x()(),className:"character-choice",onClick:function(){var a;a=e.character,l.coup(a)},src:e.front,alt:e.character,hidden:0===Object.keys(a.turnLog.target).length}))})):"exchange"===a.turnLog.action&&e?a.turnLog.exchange.drawnCards.forEach((function(e){var n=a.turnLog.exchange.hasOwnProperty("newHand")&&a.turnLog.exchange.newHand.includes(e.id);g.push(c.a.createElement("img",{key:"choice"+e.character,className:j()("big-character-choice",{"card-selected":n}),onClick:function(){var a;a=e.id,l.setHand(a)},src:e.front,alt:e.character,hidden:!a.turnLog.successful||"action"!==t.activePlayers[r]}))})):a.players[r].isOut||""!==a.turnLog.responses[r]||("block"===t.activePlayers[r]?(g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:n},"allow")),g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:s},"block"))):"challenge"===t.activePlayers[r]?(g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:n},"allow")),g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:u},"challenge"))):"blockOrChallenge"===t.activePlayers[r]&&(g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:n},"allow")),g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:s},"block")),g.push(c.a.createElement("button",{key:x()(),className:"choice-btn",onClick:u},"challenge"))));m(g)}),[a.turnLog,a.players,a.gameOver,t.currentPlayer,t.numPlayers,t.activePlayers,r,l,a.winner.id,o]),c.a.createElement("div",{id:"choosing_panel"},u)},z=(t(100),function(e){var a=e.G,t=e.ctx,r=e.playerID,l=e.moves,o=r===t.currentPlayer,s=o?"you":"".concat(a.players[t.currentPlayer].name),i=Object(n.useState)(""),u=Object(g.a)(i,2),m=u[0],d=u[1],h=Object(n.useState)(!0),p=Object(g.a)(h,2),f=p[0],y=p[1];Object(n.useEffect)((function(){d("".concat(s,o?"r turn":"'s turn")),y(!0)}),[t.currentPlayer,o,s]);var v=a.players[r].hand;return Object(n.useEffect)((function(){var e;if("loseAssassinate"===t.activePlayers[a.turnLog.target.id])a.turnLog.target.id===r?(d("choose an influence to give up (assassinated)."),y(!1)):(d("waiting for ".concat(a.turnLog.target.name," to give up an influence (assassinated)")),y(!0));else if(a.turnLog.successful&&"exchange"===a.turnLog.action&&"action"===t.activePlayers[t.currentPlayer])if(a.turnLog.player.id===r){var n=v.filter((function(e){return!e.discarded})).length;d("choose your new hand (".concat(n,").\n the top two cards from the deck are:")),y(!1)}else d("waiting for ".concat(a.turnLog.player.name," to complete the exchange")),y(!0);else if(0!==Object.keys(a.turnLog.challenge).length){var c=a.turnLog.challenge.challenger.id===r,i=1===a.turnLog.challenge.characters.length?"".concat(a.turnLog.challenge.characters[0]):"".concat(a.turnLog.challenge.characters[0]," or ").concat(a.turnLog.challenge.characters[1]);0===Object.keys(a.turnLog.challenge.loser).length?a.turnLog.challenge.challenged.id===r?(d("".concat(a.turnLog.challenge.challenger.name," challenges!\n Reveal ").concat(i," or give up a card.")),y(!1)):(d("".concat(c?"you":a.turnLog.challenge.challenger.name," challenge").concat(c?"":"s","!\n Waiting for ").concat(a.turnLog.challenge.challenged.name,"'s response")),y(!0)):"loseCard"===t.activePlayers[a.turnLog.challenge.loser.id]?a.turnLog.challenge.loser.id===r?(d("choose an influence to give up (challenge lost)."),y(!1)):(d("".concat(a.turnLog.challenge.challenged.id===r?"your new card is ".concat(a.turnLog.challenge.swapCard.character,".\n"):"","waiting for ").concat(a.turnLog.challenge.challenger.name," to give up an influence")),y(!0)):a.turnLog.challenge.successful?(d("".concat(a.turnLog.challenge.challenger.id===r?"your":"".concat(a.turnLog.challenge.challenger.name,"'s")," challenge succeeds.")),y(!1),e=setTimeout((function(){a.turnLog.challenge.challenged.id===r&&("steal"===a.turnLog.action?(0!==Object.keys(a.turnLog.blockedBy).length&&l.executeAction(),l.endTurn()):"assassinate"===a.turnLog.action&&r===a.turnLog.target.id||0!==Object.keys(a.turnLog.blockedBy).length?l.executeAction():l.endTurn())}),2e3)):(a.turnLog.challenge.challenged.id===r?d("you reveal ".concat(a.turnLog.challenge.revealedCard.name,".\n").concat(a.turnLog.challenge.challenger.name,"'s challenge fails!")):d("".concat(a.turnLog.challenge.challenged.name," reveals ").concat(a.turnLog.challenge.revealedCard.name,".\n").concat(a.turnLog.challenge.challenger.id===r?"your":"".concat(a.turnLog.challenge.challenger.name,"'s")," challenge fails!")),y(!1),t.activePlayers.hasOwnProperty(a.turnLog.challenge.challenged.id)&&(e=setTimeout((function(){a.turnLog.challenge.challenged.id===r&&("exchange"!==a.turnLog.action&&"assassinate"!==a.turnLog.action&&0===Object.keys(a.turnLog.blockedBy).length&&l.executeAction(),l.continueTurn())}),3e3)))}else if(0!==Object.keys(a.turnLog.blockedBy).length){var u=a.turnLog.blockedBy.hasOwnProperty("character")&&""!==a.turnLog.blockedBy.character;if("steal"===a.turnLog.action&&""===a.turnLog.blockedBy.character)r===a.turnLog.blockedBy.id&&(d("choose a character to block with."),y(!1));else if(o)d("".concat(a.turnLog.blockedBy.name," blocks your ").concat("assassinate"===a.turnLog.action?"assassination":a.turnLog.action).concat(u?" with ".concat(a.turnLog.blockedBy.character):"",".")),y(!1);else{var m=a.turnLog.blockedBy.id===r?"you block":"".concat(a.turnLog.blockedBy.name," blocks");u&&(m+=" with ".concat(a.turnLog.blockedBy.character)),d("".concat(m+="!","\nwaiting for ").concat(u?"a":"".concat(s,"'s")," response")),y(!0)}}else if(["coup","assassinate","steal"].includes(a.turnLog.action)){var g="steal"===a.turnLog.action?"steal from":a.turnLog.action;o?0===Object.keys(a.turnLog.target).length?(d("choose a player to ".concat(g,".")),y(!1)):"coup"===a.turnLog.action?(d("select a character to coup."),y(!1)):(d("waiting for ".concat(a.turnLog.target.name," to respond")),y(!0)):0===Object.keys(a.turnLog.target).length?(d("".concat(s," is choosing someone to ").concat(g)),y(!0)):"coup"===a.turnLog.action?(d("".concat(s," initiates a coup against ").concat(a.turnLog.target.id===r?"you":a.turnLog.target.name)),y(!0)):a.turnLog.target.id===r?(d("".concat(s," chooses to ").concat(g," you.")),y(!1)):(g="steal"===a.turnLog.action?"steals from":g+"s",d("".concat(s," ").concat(g," ").concat(a.turnLog.target.name,".\nwaiting for a response")),y(!0))}else"action"!==t.activePlayers[t.currentPlayer]&&(o?d("waiting for others to respond"):(d("".concat(s," attempts to ").concat(a.turnLog.action,".")),y(!1)));return function(){return clearTimeout(e)}}),[a.turnLog,t.activePlayers,t.currentPlayer,l,v,o,s,r]),Object(n.useEffect)((function(){"-1"!==a.winner.id&&(d("Game over!\n".concat(s," ").concat(a.winner.id===r?"are":"is"," the winner.")),y(!1))}),[a.winner,s,r]),c.a.createElement("div",{className:j()("announcement-area",{"announcement-area-offset":f})},c.a.createElement("div",{key:m,className:j()("turn-message",{"msg-loading":f})},m,c.a.createElement("span",{style:{marginLeft:"0.01vw"}})),c.a.createElement(Y,e))}),W=(t(101),function(e){var a=e.G,t=e.ctx,r=e.playerID,l=e.moves,o=e.i,s=Object(n.useState)(!1),i=Object(g.a)(s,2),u=i[0],m=i[1],d=a.players[r],h=a.players[o],p="-1"!==a.winner.id,f=[];h.hand.forEach((function(e,n){var r=!1;"revealCard"===t.activePlayers[o]&&(r=0!==a.turnLog.challenge.revealedCard.length&&e.id===a.turnLog.challenge.revealedCard.id),f.push(e.discarded?c.a.createElement("div",{key:x()(),className:"character-card character-card-discarded"}):c.a.createElement("img",{onDragStart:function(e){e.preventDefault()},draggable:!1,key:h.name+n,className:j()("character-card",{"character-card-reveal":r}),src:p||r||u?e.front:"/images/back.PNG",alt:p||r||u?e.character:"card"}))}));var y=o===parseInt(t.currentPlayer),v=r===t.currentPlayer,b=["coup","assassinate","steal"].includes(a.turnLog.action)&&v&&0===Object.keys(a.turnLog.target).length&&!h.isOut,E=d.isOut&&!h.isOut&&!p,k=o===parseInt(a.turnLog.target.id),L="";h.isOut?L="player-out":p?L="player-winner":y?L="player-entered":v&&(b?L="player-select":k&&(L="player-selected")),E&&(L+=" player-select-reveal");var O="";"allow"===a.turnLog.responses[o]?O="#008000":"block"===a.turnLog.responses[o]?O="#8b0000":"challenge"===a.turnLog.responses[o]&&(O="#42526C");var N=function(e,a){return c.a.createElement(c.a.Fragment,null,a,"\xa0(",e,")\xa0",a)};return c.a.createElement("div",{className:"player ".concat(L),onClick:function(){E?m(!u):function(){if(b){var e=h.name,a=h.id;l.setTarget({name:e,id:a})}}()}},c.a.createElement("div",{className:"player-body"},c.a.createElement("div",{className:"player-name"},h.name),c.a.createElement("div",{className:"no-gutters d-flex",style:{height:"60%"}},f),h.isOut||p?c.a.createElement("div",{className:"exiled-text"},a.gameOver.playAgain.includes(o.toString())?N("ready",c.a.createElement(A.a,{icon:B.e})):a.gameOver.left.includes(o.toString())?N("left",c.a.createElement(A.a,{icon:B.d})):h.isOut?N("exiled",c.a.createElement(A.a,{icon:B.g})):N("winner",c.a.createElement(A.a,{icon:B.c}))):c.a.createElement("div",{className:"coin-row no-gutters"},c.a.createElement("div",{className:"w-50 h-100 d-flex justify-content-end",style:{paddingRight:"1%"}},c.a.createElement("img",{onDragStart:function(e){e.preventDefault()},draggable:!1,className:"img-fluid h-100",src:"/images/coin.png",alt:"coins"})),c.a.createElement("div",{className:"w-50 d-flex align-items-center",style:{paddingLeft:"1%"}},h.coins,c.a.createElement("div",{className:"response-icon",style:{color:"".concat(O)}},""!==a.turnLog.responses[o]?"allow"===a.turnLog.responses[o]?c.a.createElement(A.a,{icon:B.i}):c.a.createElement(A.a,{icon:B.h}):"")))))}),q=(t(102),function(e){for(var a=e.ctx,t=e.playerID,n=[],r=0;r<a.numPlayers;r++){var l=parseInt(a.playOrder[r]);l!==parseInt(t)?n.push(c.a.createElement("div",{key:e.G.players[l].id+e.G.players[l].name,className:"player-container"},c.a.createElement(W,Object.assign({},e,{i:l})))):a.playOrder[r]!==a.playOrder[0]&&a.playOrder[r]!==a.playOrder[a.numPlayers-1]&&n.push(c.a.createElement("div",{key:"position marker",className:"d-flex align-items-center h-100"},c.a.createElement("div",{className:j()("position-marker",{"position-marker-active":t===a.currentPlayer})})))}return c.a.createElement("div",{className:"players"},n)}),Q=(t(103),function(e){var a=e.G,t=e.ctx,n=e.playerID,r=e.moves,l=a.players[n],o=n===t.currentPlayer,s="-1"!==a.winner.id,i=a.turnLog.exchange.hasOwnProperty("newHand")&&"action"===t.activePlayers[n]||t.activePlayers[n]&&t.activePlayers[n].includes("lose"),u=!1;"revealCard"===t.activePlayers[n]&&(i=0===Object.keys(a.turnLog.challenge.loser).length,u=!i);var m=[];l.hand.forEach((function(e,s){var g="";u&&a.turnLog.challenge.revealedCard.id===e.id||o&&a.turnLog.exchange.hasOwnProperty("newHand")&&a.turnLog.exchange.newHand.includes(e.id)?g="card-selected":i&&(g="card-selectable"),m.push(e.discarded?c.a.createElement("div",{key:x()(),className:"character-card character-card-discarded"}):c.a.createElement("img",{onDragStart:function(e){e.preventDefault()},draggable:!1,key:l.id+e.character+s,className:"character-card ".concat(g),src:e.front,onClick:function(){var c;t.activePlayers[n]&&t.activePlayers[n].includes("lose")&&!e.discarded?function(e,a){r.loseCardAndShuffle(e,a)}(n,e.id):a.turnLog.exchange.hasOwnProperty("newHand")&&o?(c=e.id,r.setHand(c)):i&&!e.discarded&&function(e,a){r.revealCard(e,a)}(n,e.id)},alt:e.character}))}));var g="";g=l.isOut?"your-player-out":s?"your-player-winner":o?"your-player-enter":"your-player-inactive";var d="";"allow"===a.turnLog.responses[n]?d="#008000":"block"===a.turnLog.responses[n]?d="#8b0000":"challenge"===a.turnLog.responses[n]&&(d="#42526C");var h=function(e,a){return c.a.createElement(c.a.Fragment,null,a,"\xa0(",e,")\xa0",a)};return c.a.createElement("div",{className:j()("your-player ".concat(g),{"your-player-selected":i&&!l.isOut})},c.a.createElement("div",{className:"player-body"},c.a.createElement("div",{className:"player-name"},l.name," (You)"),c.a.createElement("div",{className:"no-gutters d-flex",style:{height:"60%"}},m),l.isOut||s?c.a.createElement("div",{className:"exiled-text"},a.gameOver.playAgain.includes(n)?h("ready",c.a.createElement(A.a,{icon:B.e})):a.gameOver.left.includes(n)?h("left",c.a.createElement(A.a,{icon:B.d})):l.isOut?h("exiled",c.a.createElement(A.a,{icon:B.g})):h("winner",c.a.createElement(A.a,{icon:B.c}))):c.a.createElement("div",{className:"coin-row no-gutters"},c.a.createElement("div",{className:"w-50 h-100 d-flex align-items-center justify-content-end",style:{paddingRight:"1%"}},c.a.createElement("img",{onDragStart:function(e){e.preventDefault()},draggable:!1,className:"img-fluid",src:"/images/coin.png",alt:"coins",style:{height:"90%"}})),c.a.createElement("div",{className:"w-50 d-flex align-items-center justify-content-start",style:{paddingLeft:"1.2%",fontSize:"2.8vw"}},l.coins,c.a.createElement("div",{className:"response-icon",style:{paddingRight:"1vw",color:"".concat(d)}},""!==a.turnLog.responses[n]?"allow"===a.turnLog.responses[n]?c.a.createElement(A.a,{icon:B.i}):c.a.createElement(A.a,{icon:B.h}):"")))))}),V=(t(104),function(e){var a=Object(n.useState)(!1),t=Object(g.a)(a,2),r=t[0],l=t[1];return Object(n.useEffect)((function(){"0"===e.playerID&&e.moves.changeNames(e.gameMetadata)}),[e.playerID,e.moves,e.gameMetadata]),c.a.createElement("div",{className:"game-container"},c.a.createElement(q,e),c.a.createElement("div",{className:"your-container"},c.a.createElement("div",{className:"your-player-container"},c.a.createElement(Q,e)),c.a.createElement("div",{className:"messages-actions-container"},c.a.createElement(z,e),c.a.createElement(D,Object.assign({},e,{revealDeck:r}))),c.a.createElement("div",{className:"cls-col"},c.a.createElement(_,Object.assign({},e,{revealDeck:r,setRevealDeck:l})))))}),X=t(2),Z=function(e){for(var a=e.length-1;a>0;a--){var t=Math.floor(Math.random()*(a+1)),n=[e[t],e[a]];e[a]=n[0],e[t]=n[1]}},$=function(e,a,t,n,c,r,l,o,s){e.action=a,e.player=t,e.successful=n,e.target=c,e.blockedBy=r,e.challenge=l,e.responses=o,e.exchange=s},ee=function(e){for(var a=[],t=0;t<e;t++)a[t]="";return a},ae=function(e,a){a.forEach((function(a){e.deck.push(a)})),Z(e.deck)},te=t(15),ne=function(e,a){"foreign aid"===e.turnLog.action?(e.players[a.currentPlayer].coins+=2,0!==Object.keys(e.turnLog.blockedBy).length&&a.events.endTurn()):"tax"===e.turnLog.action?e.players[a.currentPlayer].coins+=3:"exchange"===e.turnLog.action?(e.turnLog.exchange.newHand=se(e.players[a.currentPlayer].hand),e.deck.pop(),e.deck.pop()):"assassinate"===e.turnLog.action?e.players[e.turnLog.target.id].isOut?a.events.endTurn():a.events.setActivePlayers({all:"idle",value:Object(te.a)({},e.turnLog.target.id,"loseAssassinate")}):"steal"===e.turnLog.action&&(e.players[e.turnLog.target.id].coins<2?(e.players[a.currentPlayer].coins+=e.players[e.turnLog.target.id].coins,e.players[e.turnLog.target.id].coins=0):(e.players[a.currentPlayer].coins+=2,e.players[e.turnLog.target.id].coins-=2))},ce=function(e,a,t){if(e.turnLog.responses[t]="allow",a.currentPlayer===t)a.events.endTurn();else if(["assassinate","steal"].includes(e.turnLog.action))e.turnLog.successful=!0,ne(e,a),"steal"===e.turnLog.action&&a.events.endTurn();else if(e.turnLog.responses.filter((function(e){return"allow"===e})).length===function(e){return e.players.filter((function(e){return!e.isOut})).length}(e)-1){e.turnLog.successful=!0,ne(e,a);["foreign aid","tax"].includes(e.turnLog.action)?a.events.endTurn():a.events.setActivePlayers({currentPlayer:"action",others:"idle"})}},re=function(e,a,t,n){e.turnLog.responses[t]="block",0===Object.keys(e.turnLog.blockedBy).length&&(e.turnLog.blockedBy={name:e.players[t].name,id:t}),"steal"===e.turnLog.action?e.turnLog.blockedBy.hasOwnProperty("character")?(e.turnLog.blockedBy.character=n,a.events.setActivePlayers({currentPlayer:"challenge",others:"idle"})):e.turnLog.blockedBy.character="":("assassinate"===e.turnLog.action?e.turnLog.blockedBy.character="Contessa":e.turnLog.blockedBy.character="Duke",a.events.setActivePlayers({currentPlayer:"challenge",others:"idle"}))},le=function(e,a,t){e.turnLog.responses[t]="challenge";var n=0!==Object.keys(e.turnLog.blockedBy).length,c=n?e.turnLog.blockedBy.id:a.currentPlayer;e.turnLog.challenge={challenger:{name:e.players[t].name,id:t},challenged:{name:e.players[c].name,id:c},characters:oe(e,n),successful:!1,loser:{},revealedCard:{},swapCard:{}},a.events.setActivePlayers({all:"idle",value:Object(te.a)({},c,"revealCard")})},oe=function(e,a){var t=e.turnLog.action;return"foreign aid"===t||"tax"===t?["Duke"]:"exchange"===t?["Ambassador"]:"assassinate"===t?a?["Contessa"]:["Assassin"]:"steal"===t?a?[e.turnLog.blockedBy.character]:["Captain"]:void 0},se=function(e){var a=[];return e.forEach((function(e){e.discarded?a.push(-1):a.push("")})),a},ie=function(e,a,t,n){if(e.turnLog.challenge.revealedCard={name:e.players[t].hand[n].character,id:n},e.turnLog.challenge.characters.includes(e.turnLog.challenge.revealedCard.name)){e.turnLog.successful=!0,e.turnLog.challenge.loser={name:e.turnLog.challenge.challenger.name,id:e.turnLog.challenge.challenger.id},ae(e,[K(e.players[t].hand[n].character,e.players[t].hand[n].front)]);var c=e.deck.pop(),r=c.character,l=c.front;e.turnLog.challenge.swapCard={character:r,front:l}}else e.turnLog.challenge.successful=!0,e.turnLog.challenge.loser={name:e.turnLog.challenge.challenged.name,id:e.turnLog.challenge.challenged.id},ue(e,a,t,n);0!==Object.keys(e.turnLog.blockedBy).length&&(e.turnLog.successful=!e.turnLog.successful)},ue=function(e,a,t,n){var c;ae(e,[K(e.players[t].hand[n].character,e.players[t].hand[n].front)]),e.players[t].hand[n]={character:"",front:"",discarded:!0,id:n},0===(c=e.players[t]).hand.filter((function(e){return!e.discarded})).length&&(c.isOut=!0),"assassinate"===e.turnLog.action&&t===e.turnLog.target.id&&"loseCard"===a.activePlayers[t]?e.players[t].isOut?a.events.endTurn():a.events.setActivePlayers({all:"idle",value:Object(te.a)({},t,"loseAssassinate")}):"exchange"!==e.turnLog.action||0===Object.keys(e.turnLog.challenge)||e.turnLog.challenge.successful?("coup"===e.turnLog.action||a.activePlayers[t].includes("lose"))&&a.events.endTurn():(e.turnLog.exchange.drawnCards=[Object(X.a)(Object(X.a)({},e.deck[e.deck.length-1]),{},{id:2}),Object(X.a)(Object(X.a)({},e.deck[e.deck.length-2]),{},{id:3})],ne(e,a),a.events.setActivePlayers({currentPlayer:"action",others:"idle"}))},me=function(e,a){var t=e.players[e.turnLog.challenge.challenged.id].hand[e.turnLog.challenge.revealedCard.id];t.character=e.turnLog.challenge.swapCard.character,t.front=e.turnLog.challenge.swapCard.front,a.events.setActivePlayers({all:"idle",value:Object(te.a)({},e.turnLog.challenge.challenger.id,"loseCard")})},ge=function(e,a,t,n){e.chat.push({id:t,content:n}),e.chat.length>35&&e.chat.shift()},de=function(e,a,t){for(var n=0;n<t.length;n++)e.players[n].name=t[n].name},he=function(e,a){a.events.endTurn()},pe=function(e,a,t){e.gameOver.playAgain.push(t)},fe=function(e,a,t){var n=e.gameOver.playAgain.indexOf(t);n>-1&&e.gameOver.playAgain.splice(n,1),e.gameOver.left.push(t)},ye=function(e,a,t){e.gameOver.newRoomID=t},ve=function(e){var a=e.successful?"successfully ":"unsuccessfully ",t="";"income"===e.action&&(a=""),"coup"===e.action?t=" ".concat(e.target.name," for ").concat(e.target.character):"assassinate"===e.action?t=" ".concat(e.target.name):"steal"===e.action&&(t=" from ".concat(e.target.name));var n=".";if(e.blockedBy&&0!==Object.keys(e.blockedBy).length&&(n+="\n\u2692 ".concat(e.blockedBy.name," blocked with ").concat(e.blockedBy.character,".")),e.challenge&&0!==Object.keys(e.challenge).length){var c=e.challenge.successful?"success":"fail";n+="\n\u2694 ".concat(e.challenge.challenger.name," challenged ").concat(e.challenge.challenged.name," (").concat(c,").")}return"".concat(e.player.name," ").concat(a).concat(e.action).concat("tax"===e.action?"es":"s").concat(t).concat(n)},be={name:"".concat("Coup"),minPlayers:2,maxPlayers:8,setup:function(e){var a=e.numPlayers,t=function(e){var a=[],t=[],n=e<=6?3:4;J.forEach((function(e){for(var t=0;t<n;t++)a.push(e)})),Z(a);for(var c=0;c<e;c++)t.push({name:"",isOut:!1,hand:[Object(X.a)(Object(X.a)({},a.pop()),{},{discarded:!1,id:0}),Object(X.a)(Object(X.a)({},a.pop()),{},{discarded:!1,id:1})],coins:2,id:"".concat(c)});return{deck:a,players:t}}(a);return{deck:t.deck,players:t.players,winner:{name:"",id:"-1"},gameOver:{playAgain:[],left:[],newRoomID:""},turnLog:{action:"",player:{},successful:!1,target:{},blockedBy:{},challenge:{},responses:ee(a),exchange:{}},statistics:[["income",0,"\u2014","\u2014","\u2014"],["foreign aid",0,0,0,"\u2014"],["coup",0,0,"\u2014","\u2014"],["tax",0,0,"\u2014",0],["assassinate",0,0,0,0],["steal",0,0,0,0],["exchange",0,0,"\u2014",0]],chat:[]}},turn:{onBegin:function(e,a){$(e.turnLog,"",{},!1,{},{},{},ee(a.numPlayers),{}),a.events.setActivePlayers({currentPlayer:"action",others:"idle"})},onEnd:function(e,a){!function(e,a){for(var t=0;t<a.length&&a[t][0]!==e.action;)t++;var n=a[t];e.successful?n[1]++:n[2]++,e.blockedBy&&0!==Object.keys(e.blockedBy).length&&n[3]++,e.challenge&&0!==Object.keys(e.challenge).length&&e.player.id===e.challenge.challenged.id&&n[4]++}(e.turnLog,e.statistics),e.chat.push({id:"-1",content:ve(e.turnLog),successful:e.turnLog.successful}),function(e){var a=e.players.filter((function(e){return!e.isOut}));1===a.length&&(e.winner.name=a[0].name,e.winner.id=a[0].id)}(e)},order:{first:function(e,a){return 0},next:function(e,a){for(var t=e.players,n=a.numPlayers,c=a.playOrder,r=a.playOrderPos,l=1;l<=n;l++){var o=(r+l)%n;if(!t[c[o]].isOut)return o}},playOrder:function(e,a){return function(e){var a=Array(e).fill().map((function(e,a){return""+a}));return Z(a),a}(a.numPlayers)}},stages:{action:{moves:{income:function(e,a){e.players[a.currentPlayer].coins++;var t=e.players[a.currentPlayer],n=t.name,c=t.id;$(e.turnLog,"income",{name:n,id:c},!0),a.events.endTurn()},prepAction:function(e,a,t){e.turnLog.action=t;var n=e.players[a.currentPlayer],c=n.name,r=n.id;e.turnLog.player={name:c,id:r},"foreign aid"===t?a.events.setActivePlayers({currentPlayer:"idle",others:"block"}):"exchange"!==t&&"tax"!==t||(a.events.setActivePlayers({currentPlayer:"idle",others:"challenge"}),e.turnLog.exchange.drawnCards=[Object(X.a)(Object(X.a)({},e.deck[e.deck.length-1]),{},{id:2}),Object(X.a)(Object(X.a)({},e.deck[e.deck.length-2]),{},{id:3})])},coup:function(e,a,t){e.turnLog.target.character=t,e.players[a.currentPlayer].coins-=7;for(var n=[],c=e.players[e.turnLog.target.id].hand,r=0;r<c.length;r++){var l=c[r];l.discarded||l.character!==t||n.push(r)}var o=n.length>0;if(e.turnLog.successful=o,o){var s=2===n.length?Math.round(Math.random()):n[0];ue(e,a,e.turnLog.target.id,s)}a.events.endTurn()},setTarget:function(e,a,t){e.turnLog.target=t,"steal"!==e.turnLog.action&&"assassinate"!==e.turnLog.action||("assassinate"===e.turnLog.action&&(e.players[a.currentPlayer].coins-=3),a.events.setActivePlayers({all:"idle",value:Object(te.a)({},t.id,"blockOrChallenge")}))},setHand:function(e,a,t){var n=e.players[a.currentPlayer].hand,c=e.turnLog.exchange.newHand;if(!c.includes(t)){var r=c.findIndex((function(e){return""===e}));c[r]=t}if(!c.includes("")){for(var l=[],o=0;o<n.length;o++){var s=n[o],i=s.character,u=s.front;l.push({character:i,front:u})}for(var m=0;m<c.length;m++){var g=c[m];if(-1!==g){var d=g<2?l[g]:e.turnLog.exchange.drawnCards[g-2];n[m].character=d.character,n[m].front=d.front}}for(var h=[],p=0;p<=1;p++)n[p].discarded||h.push(p);h.push(2),h.push(3);for(var f=h.length;f--;)c.includes(h[f])&&h.splice(f,1);for(var y=0;y<h.length;y++)h[y]=h[y]<2?l[h[y]]:e.turnLog.exchange.drawnCards[h[y]-2];ae(e,h),a.events.endTurn()}},executeAction:ne,continueTurn:me,endTurn:he,changeNames:de,leave:fe,playAgain:pe,message:ge,setNewRoom:ye}},block:{moves:{allow:ce,block:re,message:ge}},challenge:{moves:{allow:ce,initiateChallenge:le,revealCard:ie,message:ge}},blockOrChallenge:{moves:{allow:ce,block:re,initiateChallenge:le,revealCard:ie,message:ge}},revealCard:{moves:{revealCard:ie,executeAction:ne,continueTurn:me,endTurn:he,message:ge}},loseCard:{moves:{loseCardAndShuffle:ue,endTurn:he,message:ge}},loseAssassinate:{moves:{loseCardAndShuffle:ue,message:ge}},idle:{moves:{changeNames:de,message:ge,leave:fe,playAgain:pe,setNewRoom:ye}}}}},Ee=(t(105),new E),ke=window.location,Le=ke.origin,Oe=(ke.protocol,ke.hostname,Le),Ne=Object(O.a)({game:be,board:V,debug:!1,multiplayer:Object(N.b)({server:Oe})}),we=function(e){var a=e.history,t=Object(o.h)().id,r=Object(n.useState)(!1),l=Object(g.a)(r,2),s=l[0],i=l[1],u=Object(n.useState)([]),m=Object(g.a)(u,2),h=m[0],p=m[1],f=Object(n.useState)(!1),y=Object(g.a)(f,2),v=y[0],b=y[1];Object(n.useEffect)((function(){var e=setInterval((function(){Ee.getPlayers(t).then((function(e){p(e),e.filter((function(e){return e.name})).length===e.length&&b(!0)}),(function(){a.push("",{invalidRoom:!0})}))}),500);return v&&clearInterval(e),function(){clearInterval(e)}}),[v,h.length,t,a]),Object(n.useEffect)((function(){var e;return s&&(e=setTimeout((function(){document.getSelection().toString()===t&&document.getSelection().removeAllRanges(),i(!1)}),3e3)),function(){return clearTimeout(e)}}),[s,t]);return v?c.a.createElement(Ne,{gameID:t,numPlayers:h.length,playerID:localStorage.getItem("id"),credentials:localStorage.getItem("credentials")}):c.a.createElement(d,null,c.a.createElement("span",{className:"title room-title"},"Room"),c.a.createElement("div",{className:"players-list"},h.map((function(e){return e.name?e.name+"".concat(e.name===localStorage.getItem("name")?" (You)":"","\n"):"...\n"}))),c.a.createElement("div",{className:"room-info-area"},c.a.createElement("div",{className:"roomID-area"},"room id:",c.a.createElement("textarea",{id:"roomID",value:t,readOnly:!0}),c.a.createElement("button",{className:j()("copy-btn",{"copied-btn":s}),onClick:function(e){document.getElementById("roomID").select(),document.execCommand("copy"),e.target.focus(),i(!0)},disabled:s},s?"copied":"copy")),c.a.createElement("div",{className:"room-info"},"Game will begin once all",0===h.length?"":" ".concat(h.length)," players have joined."),c.a.createElement("button",{className:"leave-btn",onClick:function(){Ee.leaveRoom(t,localStorage.getItem("id"),localStorage.getItem("credentials")).then((function(){a.push("/")}))}},"leave")))},je=(t(141),t(142),t(143),function(){var e=Object(o.g)();return c.a.createElement(o.d,null,c.a.createElement(o.b,{exact:!0,path:"/"},c.a.createElement(L,{history:e})),c.a.createElement(o.b,{exact:!0,path:"/rooms/:id"},c.a.createElement(we,{history:e})),c.a.createElement(o.a,{to:"/"}))});l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(s.a,null,c.a.createElement(je,null))),document.getElementById("root"))},80:function(e,a,t){e.exports=t(144)},86:function(e,a,t){},87:function(e,a,t){},88:function(e,a,t){},89:function(e,a,t){},90:function(e,a,t){},95:function(e,a,t){},96:function(e,a,t){},97:function(e,a,t){},98:function(e,a,t){},99:function(e,a,t){}},[[80,1,2]]]);
//# sourceMappingURL=main.caf5d52b.chunk.js.map